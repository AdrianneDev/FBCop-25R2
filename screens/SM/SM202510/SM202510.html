<template>

	<qp-upload-dialog config.bind="{
		id: 'pnlNewRev',
		key: 'NewRevisionPanel',
		sessionKey: 'sessionKey_fileMaintenance',
		caption: 'File Upload',
		autoSave: false,
		renderCheckIn: true,
		renderLink: true
	}"></qp-upload-dialog>

	<qp-template name="1-1" id="Files_form" class="equal-height label-size-sm" wg-container>
		<qp-fieldset slot="A" id="col1" view.bind="Files">
			<field name="FileID"></field>
			<field name="ExternalLink">
				<qp-button id="btnCopyExternalLink" caption="Copy" class="col-auto" config.bind="{imageSet: 'main', imageKey: 'Copy'}" click.delegate="onCopyExternalLinkClick()" wg-name="CopyExternalLink"></qp-button>
			</field>
			<field name="WikiLink">
				<qp-button id="btnCopyWikiLink" caption="Copy" class="col-auto" config.bind="{imageSet: 'main', imageKey: 'Copy'}" click.delegate="onCopyWikiLinkClick()" wg-name="CopyWikiLink"></qp-button>
			</field>
		</qp-fieldset>
		<qp-fieldset slot="B" id="col2" view.bind="Files">
			<field name="IsHidden"></field>
			<field name="CheckedOutBy"></field>
			<field name="CheckedOutComment"></field>
			<field name="Tags"></field>
		</qp-fieldset>
	</qp-template>
	<qp-tabbar id="tab">
		<qp-tab id = "tabVersions" caption="Versions">
			<qp-grid id="gridRevisions" view.bind="Revisions">
			</qp-grid>
		</qp-tab>

		<qp-tab id = "tabPrimaryArticle" caption="Linked to Articles">
			<qp-grid id="gridArticles" view.bind="PagesWithFile"></qp-grid>
		</qp-tab>

		<qp-tab id = "tabEntitiesRecords" caption="Linked to Entities">
			<qp-grid id="gridEntities" view.bind="EntitiesRecords">
			</qp-grid>
		</qp-tab>

		<qp-tab id = "tabAccessRights" caption="Access Rights" if.bind="CurrentFile.AccessRights.value >= 4" load-on-demand.bind="false">
			<qp-template name="1-1" id="templateAccessRights" wg-container="CurrentFile_tab" class="stretch">
				<qp-fieldset id="frmCurrentFile1" view.bind="CurrentFile" slot="A">
					<field name="IsPublic"></field>
					<field name="IsAccessRightsFromEntities"></field>
					<field name="SelectedWikiID"></field>
					<field name="SelectedPageID" control-type="qp-tree-selector" control-config.bind="{
						treeConfig: {
							hideRootNode: true,
							idField: 'PageID',
							valueField: 'Name',
							dataMember: 'Pages',
							textField: 'Title',
							mode: 'single',
						}
					}"></field>
					<field name="PrimaryScreenID" config.bind="{displayMode: 'text'}"></field>
				</qp-fieldset>
				<qp-grid id="gridRights" view.bind="WikiAccessRightsRecs" slot="B" class="framed-section stretch" caption="Effective Access Rights">
				</qp-grid>
			</qp-template>
		</qp-tab>

		<qp-tab id = "tabSynchronization" caption="Synchronization" load-on-demand.bind="false">
			<qp-template id="form-Synchronization" name="1-1">
				<qp-fieldset id="frmCurrentFile2" view.bind="CurrentFile" wg-container="CurrentFile_tab" slot="A">
					<field name="Synchronizable"></field>
					<field name="SourceType"></field>
					<field name="SourceUri"></field>
					<field name="SourceLogin"></field>
					<field name="SourcePassword"></field>
					<field name="SshCertificateName"></field>
					<field name="SourceIsFolder"></field>
					<field name="SourceMask"></field>
					<field name="SourceNamingFormat"></field>
					<field name="SourceLastImportDate" class="control-size-m"></field>
					<field name="LastExportDate" class="control-size-m"></field>
				</qp-fieldset>
			</qp-template>
		</qp-tab>
	</qp-tabbar>

	<qp-panel caption="Check Out File" id="CheckoutComment">
		<qp-fieldset id="formCheckOutComment" view.bind="CheckoutComment">
			<field name="Comment"></field>
		</qp-fieldset>
		<footer>
			<qp-button id="PXButton1" dialog-result="OK"></qp-button>
			<qp-button id="PXButton2" caption="Close" dialog-result="Cancel"></qp-button>
		</footer>
	</qp-panel>
</template>
